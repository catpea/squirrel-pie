<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Squirrel Pie - Complete AST Node Test</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        max-width: 1400px;
        margin: 0 auto;
        padding: 40px 20px;
        background: #1e1e1e;
        color: #d4d4d4;
      }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/hoity-toity/hoity-toity.min.js"></script>
    <script src="./bread-crumb.js"></script>
  </head>
  <body>

    <div style="display: flex; gap: 1rem;">
      <div style="flex: 50%;">
        <squirrel-pie id="squirrelPie">
          if(1){
            console.log({got: 1});
            console.log({got: 2});
          }
        </squirrel-pie>
      </div>
      <div style="flex: 50%;">
        <hoity-toity id="js" language="javascript" value="console.log('bork!');"></hoity-toity>
      </div>
    </div>

    <div>
      <bread-crumb id="breadCrumb" separator="/" value='[["Home", "/home"], ["Library", "/library"], ["Data", "/library/data"]]'>
      </bread-crumb>
    </div>

    <script type="module" src="./index.js"></script>

    <script type="module">

    import ChainCollector from './chains.js'

    const chain = new ChainCollector();
    chain.first.second("Meow").third.fourth;
    console.log( ...chain );

    for (const item of chain) {
        console.log(item);
    }

    squirrelPie.addEventListener("squirrel", function(event){
      console.log(event.detail)
      js.setValue(JSON.stringify(event.detail.arrayPath,0,2));

      console.log(event.detail.astPath)
      const boop = event.detail.astPath.reduce((pathStack, currentName)=>{
        const extractName = ([name, path])=>name;
        const currentPath = pathStack.map(extractName).join("/");
        pathStack.push([currentName, currentPath]);
        return pathStack;
      } , []);

      console.log(boop.map( ([name, path])=>path ))
      console.log(boop )

      breadCrumb.setAttribute('value', JSON.stringify(boop));
    });


    breadCrumb.addEventListener('navigate', (e) => {
        console.log(e.detail.label, e.detail.url);
    });

    </script>

  </body>
</html>
